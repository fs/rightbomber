// Generated by CoffeeScript 1.3.3
var Rightbomber,
  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

Rightbomber = (function() {

  function Rightbomber() {
    this.tick = __bind(this.tick, this);

    this.run = __bind(this.run, this);

  }

  Rightbomber.prototype.keyMap = {
    d: 'right',
    w: 'up',
    a: 'left',
    s: 'down'
  };

  Rightbomber.prototype.run = function() {
    var gameLoop, map;
    map = new Map(30, 20);
    map.generate();
    (new MapView(map)).update();
    this.keyboard = new Keyboard;
    this.player = new Player(map);
    this.player2 = new Player(map);
    this.bombs = [];
    gameLoop = new GameLoop(this.tick);
    return gameLoop.run();
  };

  Rightbomber.prototype.tick = function(timeDelta) {
    var bomb, key, _i, _len, _ref, _results;
    if (this.keyboard.isKeyPressed('/')) {
      this.bombs.push(this.player.placeBomb());
    }
    key = this.keyboard.latestOf(['right', 'up', 'left', 'down']);
    if ((this.player.moving = !!key)) {
      this.player.direction = key;
    }
    this.player.olderBy(timeDelta);
    if (this.keyboard.isKeyPressed('/')) {
      this.bombs.push(this.player2.placeBomb());
    }
    key = this.keyboard.latestOf(['d', 'w', 's', 'a']);
    if ((this.player2.moving = !!key)) {
      this.player2.direction = this.keyMap[key];
    }
    this.player2.olderBy(timeDelta);
    _ref = this.bombs;
    _results = [];
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      bomb = _ref[_i];
      _results.push(bomb.move(timeDelta));
    }
    return _results;
  };

  return Rightbomber;

})();
