// Generated by CoffeeScript 1.3.3
(function() {
  var GameLoop, Keyboard, Rightbomber,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  $(function() {
    return (new Rightbomber).run();
  });

  Rightbomber = (function() {

    function Rightbomber() {
      this.run = __bind(this.run, this);
      console.log('init');
    }

    Rightbomber.prototype.run = function() {
      var gameLoop, keyboard,
        _this = this;
      console.log('run');
      keyboard = new Keyboard;
      keyboard.activate();
      gameLoop = new GameLoop(function(timeDelta) {
        return console.log("loop body");
      });
      return gameLoop.run();
    };

    return Rightbomber;

  })();

  Keyboard = (function() {

    Keyboard.prototype.keyMap = {
      38: 'up',
      40: 'down',
      37: 'left',
      39: 'right'
    };

    Keyboard.prototype.keys = {};

    function Keyboard() {
      this.activate = __bind(this.activate, this);

    }

    Keyboard.prototype.activate = function() {
      var _this = this;
      $(document).keydown(function(e) {
        return _this.keys[_this.keyMap[e.keyCode]] = true;
      });
      return $(document).keyup(function(e) {
        return _this.keys[_this.keyMap[e.keyCode]] = false;
      });
    };

    return Keyboard;

  })();

  GameLoop = (function() {

    function GameLoop(loopFunction) {
      this.loopFunction = loopFunction;
      this.run = __bind(this.run, this);

      this.lastRunTime = this.time();
    }

    GameLoop.prototype.run = function() {
      var delta, time;
      time = this.time();
      delta = time - this.lastRunTime;
      this.lastRunTime = time;
      this.loopFunction(delta);
      return setTimeout(this.run, 0);
    };

    GameLoop.prototype.time = function() {
      return (new Date).getTime();
    };

    return GameLoop;

  })();

}).call(this);
